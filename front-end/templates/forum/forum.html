{% extends "base.html" %}
{% block title %}Forum{% endblock %}
{% block content %}
<div class="forum-container">
  <div class="forum-header">
    <h2>Posty na forum</h2>
    <div class="forum-toolbar">
      <!-- Formularz filtrowania -->
      <form method="get" action="{{ url_for('forum') }}" class="filter-form">
        <label class="checkbox-label">
          <input type="checkbox" name="use_filter" onchange="this.form.submit()"
                 {% if use_filter %}checked{% endif %}>
          Filtruj po grze
        </label>

        <select name="game_id" id="game_id"
                {% if not use_filter %}disabled{% endif %}
                onchange="this.form.submit()">
          <option value="">-- wybierz grę --</option>
          {% for game in games %}
            <option value="{{ game.id }}"
              {% if selected_game == game.id %}selected{% endif %}>
              {{ game.title }}
            </option>
          {% endfor %}
          <option value="none" {% if selected_game == "none" %}selected{% endif %}>Brak gry</option>
        </select>
      </form>

      <!-- Przycisk dodawania posta -->
      <a href="{{ url_for('new_post') }}" class="btn btn-primary">+ Dodaj post</a>
    </div>
  </div>

  <div class="posts-list">
    {% for post in posts %}
      <a href="{{ url_for('post_detail', post_id=post['id']) }}">
      <div class="post-card">
        <h3>
          {{ post['title'] }}
        </h3>
        <p class="post-meta">
          <strong>Gra:</strong>
          {% if post['game'] %}
            {{ post['game']['name'] }}
          {% else %}
            brak przypisanej gry
          {% endif %}
        </p>
        <p>{{ post['body'][:150] }}...</p>
      </div>
      </a>
    {% else %}
      <p>Brak postów do wyświetlenia.</p>
    {% endfor %}
  </div>
</div>
{% endblock %}
